{% extends 'base.html' %}
{% set now =  'now' %}

{% block title %}{% if project %}Edit Proyek{% else %}Tambah Proyek Baru{% endif %} - Admin{% endblock %}

{% block content %}
<section class="uk-section animate-fade-in">
    <div class="uk-container uk-card uk-card-default uk-card-body uk-width-1-1@m uk-border-rounded" style="padding: 1rem 1rem;">
        <h1 class="uk-heading-medium uk-margin-large-bottom">{% if project %}Edit Proyek{% else %}Tambah Proyek Baru{% endif %}</h1>

        <form action="{% if project %}{{ url_for('edit_project', project_id=project._id) }}{% else %}{{ url_for('add_project') }}{% endif %}" method="POST" enctype="multipart/form-data" class="uk-form-stacked">
            <div class="uk-margin">
                <label class="uk-form-label" for="title">Judul Proyek <span class="uk-text-danger">*</span></label>
                <div class="uk-form-controls">
                    <input class="uk-input uk-border-rounded" id="title" type="text" name="title" value="{{ project.title if project else '' }}" placeholder="Nama proyek Anda" required>
                </div>
            </div>

            <div class="uk-margin">
                <label class="uk-form-label" for="description">Deskripsi <span class="uk-text-danger">*</span></label>
                <div class="uk-form-controls">
                    <textarea class="uk-textarea uk-border-rounded" id="description" name="description" rows="7" placeholder="Deskripsi singkat tentang proyek ini..." required>{{ project.description if project else '' }}</textarea>
                </div>
            </div>

            <div class="uk-margin">
                <label class="uk-form-label" for="technologies">Teknologi (Pisahkan dengan koma) <span class="uk-text-danger">*</span></label>
                <div class="uk-form-controls">
                    <input class="uk-input uk-border-rounded" id="technologies" type="text" name="technologies" value="{{ ', '.join(project.technologies) if project and project.technologies else '' }}" placeholder="Python, Flask, MongoDB, UIkit" required>
                    <small class="uk-text-meta">Contoh: Python, Flask, MongoDB, UIkit, JavaScript, dll.</small>
                </div>
            </div>

            <div class="uk-margin">
                <label class="uk-form-label" for="project_url">URL Proyek <span class="uk-text-danger">*</span></label>
                <div class="uk-form-controls">
                    <input class="uk-input uk-border-rounded" id="project_url" type="url" name="project_url" value="{{ project.project_url if project else '' }}" placeholder="https://yourproject.com" required>
                    <small class="uk-text-meta">Link ke demo langsung atau halaman proyek.</small>
                </div>
            </div>

            <div class="uk-margin">
                <label class="uk-form-label" for="github_url">URL GitHub (Opsional)</label>
                <div class="uk-form-controls">
                    <input class="uk-input uk-border-rounded" id="github_url" type="url" name="github_url" value="{{ project.github_url if project else '' }}" placeholder="https://github.com/yourproject">
                    <small class="uk-text-meta">Link ke repositori GitHub proyek.</small>
                </div>
            </div>

            <div class="uk-margin">
                <label class="uk-form-label" for="image">Gambar Proyek</label>
                <div class="uk-form-controls">
                    <div uk-form-custom="target: true">
                        <input type="file" name="image" id="image" accept="image/*">
                        <input class="uk-input uk-form-width-medium uk-border-rounded" type="text" placeholder="Pilih file gambar..." disabled>
                    </div>
                </div>
                {% if project and project.image_url %}
                <div class="uk-margin-small-top uk-text-center">
                    <p>Gambar saat ini:</p>
                    <img src="{{ project.image_url }}" alt="{{ project.title }}" width="200" class="uk-border-rounded uk-box-shadow-small">
                    <small class="uk-text-meta uk-display-block uk-margin-small-top">Gambar baru akan menggantikan yang lama.</small>
                </div>
                {% endif %}
            </div>

            <div class="uk-margin uk-text-right">
                <button class="uk-button uk-button-primary uk-margin-small-right scale-up" type="submit" style="margin-bottom: 1rem;"><span class="fas fa-save uk-margin-small-right"></span>{% if project %}Perbarui Proyek{% else %}Tambah Proyek{% endif %}</button>
                <a href="{{ url_for('admin_projects') }}" class="uk-button uk-button-default" style="margin-bottom: 1rem;"><span class="fas fa-times-circle uk-margin-small-right"></span>Batal</a>
            </div>
        </form>
    </div>
</section>
{% endblock %}